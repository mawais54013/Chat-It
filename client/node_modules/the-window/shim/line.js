/**
 * Handle toggle online/offline
 * @function line
 * @param {function} handler - Event handler
 * @param {Object} [options={}] - Optional settings
 * @param {number} [options.delay=100] Delay for callback
 */
'use strict';

var debug = require('debug');

var get = require('./get');
/** @lends line */


function line(handler) {
  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
  var _options$delay = options.delay,
      delay = _options$delay === void 0 ? 100 : _options$delay;
  var window = get('window');

  if (!window) {
    return;
  }

  var handlerWrap = function handlerWrap(connected) {
    debug('onLine', connected);
    clearTimeout(handlerWrap._handleCallTimer);
    handlerWrap._handleCallTimer = setTimeout(function () {
      handler(connected);
    }, delay);
  };

  window.addEventListener('offline', function () {
    return handlerWrap(false);
  });
  window.addEventListener('online', function () {
    return handlerWrap(true);
  });
  handlerWrap(get('navigator.onLine'));
}

module.exports = line;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpbmUuanMiXSwibmFtZXMiOlsiZGVidWciLCJyZXF1aXJlIiwiZ2V0IiwibGluZSIsImhhbmRsZXIiLCJvcHRpb25zIiwiZGVsYXkiLCJ3aW5kb3ciLCJoYW5kbGVyV3JhcCIsImNvbm5lY3RlZCIsImNsZWFyVGltZW91dCIsIl9oYW5kbGVDYWxsVGltZXIiLCJzZXRUaW1lb3V0IiwiYWRkRXZlbnRMaXN0ZW5lciIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7O0FBT0E7O0FBRUEsSUFBTUEsS0FBSyxHQUFHQyxPQUFPLENBQUMsT0FBRCxDQUFyQjs7QUFDQSxJQUFNQyxHQUFHLEdBQUdELE9BQU8sQ0FBQyxPQUFELENBQW5CO0FBRUE7OztBQUNBLFNBQVNFLElBQVQsQ0FBY0MsT0FBZCxFQUFxQztBQUFBLE1BQWRDLE9BQWMsdUVBQUosRUFBSTtBQUFBLHVCQUNYQSxPQURXLENBQzNCQyxLQUQyQjtBQUFBLE1BQzNCQSxLQUQyQiwrQkFDbkIsR0FEbUI7QUFFbkMsTUFBTUMsTUFBTSxHQUFHTCxHQUFHLENBQUMsUUFBRCxDQUFsQjs7QUFDQSxNQUFJLENBQUNLLE1BQUwsRUFBYTtBQUNYO0FBQ0Q7O0FBQ0QsTUFBTUMsV0FBVyxHQUFHLFNBQWRBLFdBQWMsQ0FBQ0MsU0FBRCxFQUFlO0FBQ2pDVCxJQUFBQSxLQUFLLENBQUMsUUFBRCxFQUFXUyxTQUFYLENBQUw7QUFDQUMsSUFBQUEsWUFBWSxDQUFDRixXQUFXLENBQUNHLGdCQUFiLENBQVo7QUFDQUgsSUFBQUEsV0FBVyxDQUFDRyxnQkFBWixHQUErQkMsVUFBVSxDQUFDLFlBQU07QUFDOUNSLE1BQUFBLE9BQU8sQ0FBQ0ssU0FBRCxDQUFQO0FBQ0QsS0FGd0MsRUFFdENILEtBRnNDLENBQXpDO0FBR0QsR0FORDs7QUFPQUMsRUFBQUEsTUFBTSxDQUFDTSxnQkFBUCxDQUF3QixTQUF4QixFQUFtQztBQUFBLFdBQU1MLFdBQVcsQ0FBQyxLQUFELENBQWpCO0FBQUEsR0FBbkM7QUFDQUQsRUFBQUEsTUFBTSxDQUFDTSxnQkFBUCxDQUF3QixRQUF4QixFQUFrQztBQUFBLFdBQU1MLFdBQVcsQ0FBQyxJQUFELENBQWpCO0FBQUEsR0FBbEM7QUFDQUEsRUFBQUEsV0FBVyxDQUFDTixHQUFHLENBQUMsa0JBQUQsQ0FBSixDQUFYO0FBQ0Q7O0FBRURZLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQlosSUFBakIiLCJzb3VyY2VSb290IjoiLi4vbGliIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBIYW5kbGUgdG9nZ2xlIG9ubGluZS9vZmZsaW5lXG4gKiBAZnVuY3Rpb24gbGluZVxuICogQHBhcmFtIHtmdW5jdGlvbn0gaGFuZGxlciAtIEV2ZW50IGhhbmRsZXJcbiAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9ucz17fV0gLSBPcHRpb25hbCBzZXR0aW5nc1xuICogQHBhcmFtIHtudW1iZXJ9IFtvcHRpb25zLmRlbGF5PTEwMF0gRGVsYXkgZm9yIGNhbGxiYWNrXG4gKi9cbid1c2Ugc3RyaWN0J1xuXG5jb25zdCBkZWJ1ZyA9IHJlcXVpcmUoJ2RlYnVnJylcbmNvbnN0IGdldCA9IHJlcXVpcmUoJy4vZ2V0JylcblxuLyoqIEBsZW5kcyBsaW5lICovXG5mdW5jdGlvbiBsaW5lKGhhbmRsZXIsIG9wdGlvbnMgPSB7fSkge1xuICBjb25zdCB7IGRlbGF5ID0gMTAwIH0gPSBvcHRpb25zXG4gIGNvbnN0IHdpbmRvdyA9IGdldCgnd2luZG93JylcbiAgaWYgKCF3aW5kb3cpIHtcbiAgICByZXR1cm5cbiAgfVxuICBjb25zdCBoYW5kbGVyV3JhcCA9IChjb25uZWN0ZWQpID0+IHtcbiAgICBkZWJ1Zygnb25MaW5lJywgY29ubmVjdGVkKVxuICAgIGNsZWFyVGltZW91dChoYW5kbGVyV3JhcC5faGFuZGxlQ2FsbFRpbWVyKVxuICAgIGhhbmRsZXJXcmFwLl9oYW5kbGVDYWxsVGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIGhhbmRsZXIoY29ubmVjdGVkKVxuICAgIH0sIGRlbGF5KVxuICB9XG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdvZmZsaW5lJywgKCkgPT4gaGFuZGxlcldyYXAoZmFsc2UpKVxuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignb25saW5lJywgKCkgPT4gaGFuZGxlcldyYXAodHJ1ZSkpXG4gIGhhbmRsZXJXcmFwKGdldCgnbmF2aWdhdG9yLm9uTGluZScpKVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGxpbmVcbiJdfQ==