'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _assertThisInitialized2 = _interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));

var _classnames = _interopRequireDefault(require("classnames"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _react = _interopRequireDefault(require("react"));

var _theCheck = require("the-check");

var _theColor = require("the-color");

var _theComponentUtil = require("the-component-util");

var _theIcon = require("the-icon");

var _theLink = require("the-link");

var _TheButtonGroup = _interopRequireDefault(require("./TheButtonGroup"));

/**
 * Button of the-components
 */
var TheButton =
/*#__PURE__*/
function (_React$Component) {
  (0, _inherits2.default)(TheButton, _React$Component);
  (0, _createClass2.default)(TheButton, null, [{
    key: "Next",
    value: function Next(props) {
      return _react.default.createElement(TheButton, (0, _extends2.default)({
        iconRight: TheButton.NEXT_ICON
      }, props));
    }
  }, {
    key: "Prev",
    value: function Prev(props) {
      return _react.default.createElement(TheButton, (0, _extends2.default)({
        icon: TheButton.PREV_ICON
      }, props));
    }
  }, {
    key: "Spinner",
    value: function Spinner() {
      return _react.default.createElement("span", {
        className: "the-button-spinner"
      }, _react.default.createElement(_theIcon.TheIcon.Spin, {
        className: "the-button-spinner-icon"
      }));
    }
  }]);

  function TheButton(props) {
    var _this;

    (0, _classCallCheck2.default)(this, TheButton);
    _this = (0, _possibleConstructorReturn2.default)(this, (0, _getPrototypeOf2.default)(TheButton).call(this, props));
    _this.handleKeyDown = _this.handleKeyDown.bind((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)));
    _this.handleClick = _this.handleClick.bind((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)));
    _this.lastClickedAt = null;
    return _this;
  }

  (0, _createClass2.default)(TheButton, [{
    key: "handleClick",
    value: function handleClick(e) {
      var _this$props = this.props,
          minInterval = _this$props.minInterval,
          onClick = _this$props.onClick,
          onSubmit = _this$props.onSubmit;

      if (this.lastClickedAt) {
        var sinceLast = new Date() - this.lastClickedAt;
        var tooSoon = sinceLast < minInterval;

        if (tooSoon) {
          (0, _theCheck.unlessProduction)(function () {
            console.warn("[TheButton] Prevent double click ( minInterval: ".concat(minInterval, "ms, actual: ").concat(sinceLast, "ms )"));
          });
          return;
        }
      }

      onClick && onClick(e);
      onSubmit && onSubmit();
      this.lastClickedAt = new Date();
    }
  }, {
    key: "handleKeyDown",
    value: function handleKeyDown(e) {
      var _this$props2 = this.props,
          onClick = _this$props2.onClick,
          onKeyDown = _this$props2.onKeyDown,
          onSubmit = _this$props2.onSubmit;

      switch (e.keyCode) {
        case 32:
          // Space key
          e.preventDefault();
          onSubmit && onSubmit();
          onClick && onClick();
          break;

        default:
          break;
      }

      onKeyDown && onKeyDown(e);
    }
  }, {
    key: "render",
    value: function render() {
      var props = this.props;
      var children = props.children,
          className = props.className,
          color = props.color,
          danger = props.danger,
          disabled = props.disabled,
          floated = props.floated,
          icon = props.icon,
          iconRight = props.iconRight,
          large = props.large,
          largeIcon = props.largeIcon,
          light = props.light,
          primary = props.primary,
          rounded = props.rounded,
          simple = props.simple,
          small = props.small,
          spinning = props.spinning,
          _props$style = props.style,
          style = _props$style === void 0 ? {} : _props$style,
          target = props.target,
          text = props.text,
          to = props.to,
          wide = props.wide;
      var A = to ? _theLink.TheLink : 'a';
      var applyColor = color && !danger && !disabled;

      if (applyColor && style) {
        style.borderColor = color;

        if (primary) {
          style.backgroundColor = color;
          style.color = (0, _theColor.textColorFor)(color);
        } else {
          style.color = color;
        }
      }

      return _react.default.createElement(A, (0, _extends2.default)({}, (0, _theComponentUtil.htmlAttributesFor)(props, {
        except: ['className', 'style', 'icon', 'to', 'color', 'iconRight']
      }), (0, _theComponentUtil.eventHandlersFor)(props, {
        except: ['onClick']
      }), {
        "aria-busy": spinning,
        className: (0, _classnames.default)('the-button', className, {
          'the-button-danger': danger,
          'the-button-disabled': disabled,
          'the-button-floated': floated,
          'the-button-large': large,
          'the-button-light': light,
          'the-button-primary': primary,
          'the-button-rounded': rounded,
          'the-button-simple': simple,
          'the-button-small': small,
          'the-button-spinning': spinning,
          'the-button-vertical': !!largeIcon,
          'the-button-wide': wide
        }),
        onClick: this.handleClick
      }, {
        style: style,
        target: target,
        to: to
      }, {
        href: !to && props.href || 'javascript:void(0)',
        onKeyDown: this.handleKeyDown
      }), _react.default.createElement("span", {
        className: "the-button-inner"
      }, spinning && _react.default.createElement(TheButton.Spinner, null), largeIcon && _react.default.createElement(_theIcon.TheIcon, {
        className: (0, _classnames.default)('the-button-large-icon', largeIcon)
      }), icon && _react.default.createElement(_theIcon.TheIcon, {
        className: (0, _classnames.default)('the-button-icon', icon)
      }), text && _react.default.createElement("span", {
        className: (0, _classnames.default)('the-button-text')
      }, text), children, iconRight && _react.default.createElement(_theIcon.TheIcon, {
        className: (0, _classnames.default)('the-button-icon', 'the-button-icon-right', iconRight)
      })));
    }
  }]);
  return TheButton;
}(_react.default.Component);

TheButton.Group = _TheButtonGroup.default;
TheButton.PREV_ICON = 'fas fa-caret-left';
TheButton.NEXT_ICON = 'fas fa-caret-right';
TheButton.propTypes = {
  /** Color theme */
  color: _propTypes.default.string,

  /** Danger style */
  danger: _propTypes.default.bool,

  /** Disabled state */
  disabled: _propTypes.default.bool,

  /** Floated style */
  floated: _propTypes.default.bool,

  /** Icon class */
  icon: _propTypes.default.string,

  /** Large style */
  large: _propTypes.default.bool,

  /** Large icon class */
  largeIcon: _propTypes.default.string,

  /** Light color */
  light: _propTypes.default.bool,

  /** Minimum interval */
  minInterval: _propTypes.default.number,

  /** Handle submit */
  onSubmit: _propTypes.default.func,

  /** Primary style */
  primary: _propTypes.default.bool,

  /** Rounded style */
  rounded: _propTypes.default.bool,

  /** Simple style */
  simple: _propTypes.default.bool,

  /** Small style */
  small: _propTypes.default.bool,

  /** Show spinner */
  spinning: _propTypes.default.bool,

  /** Button text */
  text: _propTypes.default.string,

  /** Wide style */
  wide: _propTypes.default.bool
};
TheButton.defaultProps = {
  color: null,
  danger: false,
  disabled: false,
  floated: false,
  icon: null,
  large: false,
  largeIcon: null,
  light: false,
  minInterval: 300,
  onSubmit: null,
  primary: false,
  role: 'button',
  rounded: false,
  simple: false,
  small: false,
  spinning: false,
  text: null,
  wide: false
};
TheButton.displayName = 'TheButton';
var _default = TheButton;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlRoZUJ1dHRvbi5qc3giXSwibmFtZXMiOlsiVGhlQnV0dG9uIiwicHJvcHMiLCJORVhUX0lDT04iLCJQUkVWX0lDT04iLCJoYW5kbGVLZXlEb3duIiwiYmluZCIsImhhbmRsZUNsaWNrIiwibGFzdENsaWNrZWRBdCIsImUiLCJtaW5JbnRlcnZhbCIsIm9uQ2xpY2siLCJvblN1Ym1pdCIsInNpbmNlTGFzdCIsIkRhdGUiLCJ0b29Tb29uIiwiY29uc29sZSIsIndhcm4iLCJvbktleURvd24iLCJrZXlDb2RlIiwicHJldmVudERlZmF1bHQiLCJjaGlsZHJlbiIsImNsYXNzTmFtZSIsImNvbG9yIiwiZGFuZ2VyIiwiZGlzYWJsZWQiLCJmbG9hdGVkIiwiaWNvbiIsImljb25SaWdodCIsImxhcmdlIiwibGFyZ2VJY29uIiwibGlnaHQiLCJwcmltYXJ5Iiwicm91bmRlZCIsInNpbXBsZSIsInNtYWxsIiwic3Bpbm5pbmciLCJzdHlsZSIsInRhcmdldCIsInRleHQiLCJ0byIsIndpZGUiLCJBIiwiVGhlTGluayIsImFwcGx5Q29sb3IiLCJib3JkZXJDb2xvciIsImJhY2tncm91bmRDb2xvciIsImV4Y2VwdCIsImhyZWYiLCJSZWFjdCIsIkNvbXBvbmVudCIsIkdyb3VwIiwiVGhlQnV0dG9uR3JvdXAiLCJwcm9wVHlwZXMiLCJQcm9wVHlwZXMiLCJzdHJpbmciLCJib29sIiwibnVtYmVyIiwiZnVuYyIsImRlZmF1bHRQcm9wcyIsInJvbGUiLCJkaXNwbGF5TmFtZSJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBRUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBRUE7OztJQUdNQSxTOzs7Ozs7eUJBQ1FDLEssRUFBTztBQUNqQixhQUFPLDZCQUFDLFNBQUQ7QUFBVyxRQUFBLFNBQVMsRUFBRUQsU0FBUyxDQUFDRTtBQUFoQyxTQUErQ0QsS0FBL0MsRUFBUDtBQUNEOzs7eUJBRVdBLEssRUFB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cnQgYyBmcm9tICdjbGFzc25hbWVzJ1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJ1xuaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0J1xuaW1wb3J0IHsgdW5sZXNzUHJvZHVjdGlvbiB9IGZyb20gJ3RoZS1jaGVjaydcbmltcG9ydCB7IHRleHRDb2xvckZvciB9IGZyb20gJ3RoZS1jb2xvcidcbmltcG9ydCB7IGV2ZW50SGFuZGxlcnNGb3IsIGh0bWxBdHRyaWJ1dGVzRm9yIH0gZnJvbSAndGhlLWNvbXBvbmVudC11dGlsJ1xuaW1wb3J0IHsgVGhlSWNvbiB9IGZyb20gJ3RoZS1pY29uJ1xuaW1wb3J0IHsgVGhlTGluayB9IGZyb20gJ3RoZS1saW5rJ1xuaW1wb3J0IFRoZUJ1dHRvbkdyb3VwIGZyb20gJy4vVGhlQnV0dG9uR3JvdXAnXG5cbi8qKlxuICogQnV0dG9uIG9mIHRoZS1jb21wb25lbnRzXG4gKi9cbmNsYXNzIFRoZUJ1dHRvbiBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gIHN0YXRpYyBOZXh0KHByb3BzKSB7XG4gICAgcmV0dXJuIDxUaGVCdXR0b24gaWNvblJpZ2h0PXtUaGVCdXR0b24uTkVYVF9JQ09OfSB7Li4ucHJvcHN9IC8+XG4gIH1cblxuICBzdGF0aWMgUHJldihwcm9wcykge1xuICAgIHJldHVybiA8VGhlQnV0dG9uIGljb249e1RoZUJ1dHRvbi5QUkVWX0lDT059IHsuLi5wcm9wc30gLz5cbiAgfVxuXG4gIHN0YXRpYyBTcGlubmVyKCkge1xuICAgIHJldHVybiAoXG4gICAgICA8c3BhbiBjbGFzc05hbWU9J3RoZS1idXR0b24tc3Bpbm5lcic+XG4gICAgICAgIDxUaGVJY29uLlNwaW4gY2xhc3NOYW1lPSd0aGUtYnV0dG9uLXNwaW5uZXItaWNvbicgLz5cbiAgICAgIDwvc3Bhbj5cbiAgICApXG4gIH1cblxuICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICAgIHN1cGVyKHByb3BzKVxuICAgIHRoaXMuaGFuZGxlS2V5RG93biA9IHRoaXMuaGFuZGxlS2V5RG93bi5iaW5kKHRoaXMpXG4gICAgdGhpcy5oYW5kbGVDbGljayA9IHRoaXMuaGFuZGxlQ2xpY2suYmluZCh0aGlzKVxuICAgIHRoaXMubGFzdENsaWNrZWRBdCA9IG51bGxcbiAgfVxuXG4gIGhhbmRsZUNsaWNrKGUpIHtcbiAgICBjb25zdCB7IG1pbkludGVydmFsLCBvbkNsaWNrLCBvblN1Ym1pdCB9ID0gdGhpcy5wcm9wc1xuICAgIGlmICh0aGlzLmxhc3RDbGlja2VkQXQpIHtcbiAgICAgIGNvbnN0IHNpbmNlTGFzdCA9IG5ldyBEYXRlKCkgLSB0aGlzLmxhc3RDbGlja2VkQXRcbiAgICAgIGNvbnN0IHRvb1Nvb24gPSBzaW5jZUxhc3QgPCBtaW5JbnRlcnZhbFxuICAgICAgaWYgKHRvb1Nvb24pIHtcbiAgICAgICAgdW5sZXNzUHJvZHVjdGlvbigoKSA9PiB7XG4gICAgICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAgICAgYFtUaGVCdXR0b25dIFByZXZlbnQgZG91YmxlIGNsaWNrICggbWluSW50ZXJ2YWw6ICR7bWluSW50ZXJ2YWx9bXMsIGFjdHVhbDogJHtzaW5jZUxhc3R9bXMgKWAsXG4gICAgICAgICAgKVxuICAgICAgICB9KVxuICAgICAgICByZXR1cm5cbiAgICAgIH1cbiAgICB9XG4gICAgb25DbGljayAmJiBvbkNsaWNrKGUpXG4gICAgb25TdWJtaXQgJiYgb25TdWJtaXQoKVxuICAgIHRoaXMubGFzdENsaWNrZWRBdCA9IG5ldyBEYXRlKClcbiAgfVxuXG4gIGhhbmRsZUtleURvd24oZSkge1xuICAgIGNvbnN0IHsgb25DbGljaywgb25LZXlEb3duLCBvblN1Ym1pdCB9ID0gdGhpcy5wcm9wc1xuICAgIHN3aXRjaCAoZS5rZXlDb2RlKSB7XG4gICAgICBjYXNlIDMyOiAvLyBTcGFjZSBrZXlcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpXG4gICAgICAgIG9uU3VibWl0ICYmIG9uU3VibWl0KClcbiAgICAgICAgb25DbGljayAmJiBvbkNsaWNrKClcbiAgICAgICAgYnJlYWtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGJyZWFrXG4gICAgfVxuICAgIG9uS2V5RG93biAmJiBvbktleURvd24oZSlcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7IHByb3BzIH0gPSB0aGlzXG4gICAgY29uc3Qge1xuICAgICAgY2hpbGRyZW4sXG4gICAgICBjbGFzc05hbWUsXG4gICAgICBjb2xvcixcbiAgICAgIGRhbmdlcixcbiAgICAgIGRpc2FibGVkLFxuICAgICAgZmxvYXRlZCxcbiAgICAgIGljb24sXG4gICAgICBpY29uUmlnaHQsXG4gICAgICBsYXJnZSxcbiAgICAgIGxhcmdlSWNvbixcbiAgICAgIGxpZ2h0LFxuICAgICAgcHJpbWFyeSxcbiAgICAgIHJvdW5kZWQsXG4gICAgICBzaW1wbGUsXG4gICAgICBzbWFsbCxcbiAgICAgIHNwaW5uaW5nLFxuICAgICAgc3R5bGUgPSB7fSxcbiAgICAgIHRhcmdldCxcbiAgICAgIHRleHQsXG4gICAgICB0byxcbiAgICAgIHdpZGUsXG4gICAgfSA9IHByb3BzXG4gICAgY29uc3QgQSA9IHRvID8gVGhlTGluayA6ICdhJ1xuXG4gICAgY29uc3QgYXBwbHlDb2xvciA9IGNvbG9yICYmICFkYW5nZXIgJiYgIWRpc2FibGVkXG4gICAgaWYgKGFwcGx5Q29sb3IgJiYgc3R5bGUpIHtcbiAgICAgIHN0eWxlLmJvcmRlckNvbG9yID0gY29sb3JcbiAgICAgIGlmIChwcmltYXJ5KSB7XG4gICAgICAgIHN0eWxlLmJhY2tncm91bmRDb2xvciA9IGNvbG9yXG4gICAgICAgIHN0eWxlLmNvbG9yID0gdGV4dENvbG9yRm9yKGNvbG9yKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc3R5bGUuY29sb3IgPSBjb2xvclxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gKFxuICAgICAgPEFcbiAgICAgICAgey4uLmh0bWxBdHRyaWJ1dGVzRm9yKHByb3BzLCB7XG4gICAgICAgICAgZXhjZXB0OiBbJ2NsYXNzTmFtZScsICdzdHlsZScsICdpY29uJywgJ3RvJywgJ2NvbG9yJywgJ2ljb25SaWdodCddLFxuICAgICAgICB9KX1cbiAgICAgICAgey4uLmV2ZW50SGFuZGxlcnNGb3IocHJvcHMsIHsgZXhjZXB0OiBbJ29uQ2xpY2snXSB9KX1cbiAgICAgICAgYXJpYS1idXN5PXtzcGlubmluZ31cbiAgICAgICAgY2xhc3NOYW1lPXtjKCd0aGUtYnV0dG9uJywgY2xhc3NOYW1lLCB7XG4gICAgICAgICAgJ3RoZS1idXR0b24tZGFuZ2VyJzogZGFuZ2VyLFxuICAgICAgICAgICd0aGUtYnV0dG9uLWRpc2FibGVkJzogZGlzYWJsZWQsXG4gICAgICAgICAgJ3RoZS1idXR0b24tZmxvYXRlZCc6IGZsb2F0ZWQsXG4gICAgICAgICAgJ3RoZS1idXR0b24tbGFyZ2UnOiBsYXJnZSxcbiAgICAgICAgICAndGhlLWJ1dHRvbi1saWdodCc6IGxpZ2h0LFxuICAgICAgICAgICd0aGUtYnV0dG9uLXByaW1hcnknOiBwcmltYXJ5LFxuICAgICAgICAgICd0aGUtYnV0dG9uLXJvdW5kZWQnOiByb3VuZGVkLFxuICAgICAgICAgICd0aGUtYnV0dG9uLXNpbXBsZSc6IHNpbXBsZSxcbiAgICAgICAgICAndGhlLWJ1dHRvbi1zbWFsbCc6IHNtYWxsLFxuICAgICAgICAgICd0aGUtYnV0dG9uLXNwaW5uaW5nJzogc3Bpbm5pbmcsXG4gICAgICAgICAgJ3RoZS1idXR0b24tdmVydGljYWwnOiAhIWxhcmdlSWNvbixcbiAgICAgICAgICAndGhlLWJ1dHRvbi13aWRlJzogd2lkZSxcbiAgICAgICAgfSl9XG4gICAgICAgIG9uQ2xpY2s9e3RoaXMuaGFuZGxlQ2xpY2t9XG4gICAgICAgIHsuLi57IHN0eWxlLCB0YXJnZXQsIHRvIH19XG4gICAgICAgIGhyZWY9eyghdG8gJiYgcHJvcHMuaHJlZikgfHwgJ2phdmFzY3JpcHQ6dm9pZCgwKSd9XG4gICAgICAgIG9uS2V5RG93bj17dGhpcy5oYW5kbGVLZXlEb3dufVxuICAgICAgPlxuICAgICAgICA8c3BhbiBjbGFzc05hbWU9J3RoZS1idXR0b24taW5uZXInPlxuICAgICAgICAgIHtzcGlubmluZyAmJiA8VGhlQnV0dG9uLlNwaW5uZXIgLz59XG4gICAgICAgICAge2xhcmdlSWNvbiAmJiAoXG4gICAgICAgICAgICA8VGhlSWNvbiBjbGFzc05hbWU9e2MoJ3RoZS1idXR0b24tbGFyZ2UtaWNvbicsIGxhcmdlSWNvbil9IC8+XG4gICAgICAgICAgKX1cbiAgICAgICAgICB7aWNvbiAmJiA8VGhlSWNvbiBjbGFzc05hbWU9e2MoJ3RoZS1idXR0b24taWNvbicsIGljb24pfSAvPn1cbiAgICAgICAgICB7dGV4dCAmJiA8c3BhbiBjbGFzc05hbWU9e2MoJ3RoZS1idXR0b24tdGV4dCcpfT57dGV4dH08L3NwYW4+fVxuICAgICAgICAgIHtjaGlsZHJlbn1cbiAgICAgICAgICB7aWNvblJpZ2h0ICYmIChcbiAgICAgICAgICAgIDxUaGVJY29uXG4gICAgICAgICAgICAgIGNsYXNzTmFtZT17YyhcbiAgICAgICAgICAgICAgICAndGhlLWJ1dHRvbi1pY29uJyxcbiAgICAgICAgICAgICAgICAndGhlLWJ1dHRvbi1pY29uLXJpZ2h0JyxcbiAgICAgICAgICAgICAgICBpY29uUmlnaHQsXG4gICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICl9XG4gICAgICAgIDwvc3Bhbj5cbiAgICAgIDwvQT5cbiAgICApXG4gIH1cbn1cblxuVGhlQnV0dG9uLkdyb3VwID0gVGhlQnV0dG9uR3JvdXBcblRoZUJ1dHRvbi5QUkVWX0lDT04gPSAnZmFzIGZhLWNhcmV0LWxlZnQnXG5UaGVCdXR0b24uTkVYVF9JQ09OID0gJ2ZhcyBmYS1jYXJldC1yaWdodCdcblxuVGhlQnV0dG9uLnByb3BUeXBlcyA9IHtcbiAgLyoqIENvbG9yIHRoZW1lICovXG4gIGNvbG9yOiBQcm9wVHlwZXMuc3RyaW5nLFxuICAvKiogRGFuZ2VyIHN0eWxlICovXG4gIGRhbmdlcjogUHJvcFR5cGVzLmJvb2wsXG4gIC8qKiBEaXNhYmxlZCBzdGF0ZSAqL1xuICBkaXNhYmxlZDogUHJvcFR5cGVzLmJvb2wsXG4gIC8qKiBGbG9hdGVkIHN0eWxlICovXG4gIGZsb2F0ZWQ6IFByb3BUeXBlcy5ib29sLFxuICAvKiogSWNvbiBjbGFzcyAqL1xuICBpY29uOiBQcm9wVHlwZXMuc3RyaW5nLFxuICAvKiogTGFyZ2Ugc3R5bGUgKi9cbiAgbGFyZ2U6IFByb3BUeXBlcy5ib29sLFxuICAvKiogTGFyZ2UgaWNvbiBjbGFzcyAqL1xuICBsYXJnZUljb246IFByb3BUeXBlcy5zdHJpbmcsXG4gIC8qKiBMaWdodCBjb2xvciAqL1xuICBsaWdodDogUHJvcFR5cGVzLmJvb2wsXG4gIC8qKiBNaW5pbXVtIGludGVydmFsICovXG4gIG1pbkludGVydmFsOiBQcm9wVHlwZXMubnVtYmVyLFxuICAvKiogSGFuZGxlIHN1Ym1pdCAqL1xuICBvblN1Ym1pdDogUHJvcFR5cGVzLmZ1bmMsXG4gIC8qKiBQcmltYXJ5IHN0eWxlICovXG4gIHByaW1hcnk6IFByb3BUeXBlcy5ib29sLFxuICAvKiogUm91bmRlZCBzdHlsZSAqL1xuICByb3VuZGVkOiBQcm9wVHlwZXMuYm9vbCxcbiAgLyoqIFNpbXBsZSBzdHlsZSAqL1xuICBzaW1wbGU6IFByb3BUeXBlcy5ib29sLFxuICAvKiogU21hbGwgc3R5bGUgKi9cbiAgc21hbGw6IFByb3BUeXBlcy5ib29sLFxuICAvKiogU2hvdyBzcGlubmVyICovXG4gIHNwaW5uaW5nOiBQcm9wVHlwZXMuYm9vbCxcbiAgLyoqIEJ1dHRvbiB0ZXh0ICovXG4gIHRleHQ6IFByb3BUeXBlcy5zdHJpbmcsXG4gIC8qKiBXaWRlIHN0eWxlICovXG4gIHdpZGU6IFByb3BUeXBlcy5ib29sLFxufVxuXG5UaGVCdXR0b24uZGVmYXVsdFByb3BzID0ge1xuICBjb2xvcjogbnVsbCxcbiAgZGFuZ2VyOiBmYWxzZSxcbiAgZGlzYWJsZWQ6IGZhbHNlLFxuICBmbG9hdGVkOiBmYWxzZSxcbiAgaWNvbjogbnVsbCxcbiAgbGFyZ2U6IGZhbHNlLFxuICBsYXJnZUljb246IG51bGwsXG4gIGxpZ2h0OiBmYWxzZSxcbiAgbWluSW50ZXJ2YWw6IDMwMCxcbiAgb25TdWJtaXQ6IG51bGwsXG4gIHByaW1hcnk6IGZhbHNlLFxuICByb2xlOiAnYnV0dG9uJyxcbiAgcm91bmRlZDogZmFsc2UsXG4gIHNpbXBsZTogZmFsc2UsXG4gIHNtYWxsOiBmYWxzZSxcbiAgc3Bpbm5pbmc6IGZhbHNlLFxuICB0ZXh0OiBudWxsLFxuICB3aWRlOiBmYWxzZSxcbn1cblxuVGhlQnV0dG9uLmRpc3BsYXlOYW1lID0gJ1RoZUJ1dHRvbidcblxuZXhwb3J0IGRlZmF1bHQgVGhlQnV0dG9uXG4iXX0=