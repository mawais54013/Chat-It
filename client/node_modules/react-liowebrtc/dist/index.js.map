{"version":3,"file":"index.js","sources":["../src/LioWebRTCContext.js","../src/LioWebRTC/index.js","../src/LocalVideo/index.js","../src/RemoteVideo/index.js"],"sourcesContent":["import React from 'react';\n\nconst Context = React.createContext();\n\nexport function withWebRTC(Component, childType = null) {\n  return function ContextComponent(props) {\n    return (\n      <Context.Consumer>\n        {webrtc => (<Component {...props} webrtc={webrtc} />)}\n      </Context.Consumer>\n    );\n  }\n}\n\nexport default Context;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Liowebrtc from 'liowebrtc';\nimport Context from '../LioWebRTCContext';\n\nclass LioWebRTC extends React.Component {\n  constructor(props) {\n    super(props);\n    this.webrtc = new Liowebrtc(props.options);\n  }\n\n  componentDidMount() {\n    const {\n      onReady,\n      onReceivedPeerData,\n      onChannelOpen,\n      onConnectionReady,\n      onCreatedPeer,\n      onPeerStreamAdded,\n      onPeerStreamRemoved,\n      onRemovedPeer,\n      onIceConnectionStateChange,\n      onSignalingStateChange,\n      onLeftRoom,\n      onJoinedRoom,\n      onPeerMute,\n      onReceivedSignalData,\n      onPeerUnmute,\n      onConnectionError\n    } = this.props;\n\n    onReceivedPeerData && this.webrtc.on('receivedPeerData', function(...args) {\n      onReceivedPeerData(this, ...args);\n    });\n    onReady && this.webrtc.on('ready', function(...args) {\n      onReady(this, ...args);\n    });\n    onChannelOpen && this.webrtc.on('channelOpen', function(...args) {\n      onChannelOpen(this, ...args);\n    });\n    onConnectionReady && this.webrtc.on('connectionReady', function(...args) {\n      onConnectionReady(this, ...args);\n    });\n    onCreatedPeer && this.webrtc.on('createdPeer', function(...args) {\n      onCreatedPeer(this, ...args);\n    });\n    onPeerStreamRemoved && this.webrtc.on('peerStreamRemoved', function(...args) {\n      onPeerStreamRemoved(this, ...args);\n    });\n    onIceConnectionStateChange && this.webrtc.on('iceConnectionStateChange', function(...args) {\n      onIceConnectionStateChange(this, ...args);\n    });\n    onSignalingStateChange && this.webrtc.on('signalingStateChange', function(...args) {\n      onSignalingStateChange(this, ...args);\n    });\n    onLeftRoom && this.webrtc.on('leftRoom', function(...args) {\n      onLeftRoom(this, ...args);\n    });\n    onJoinedRoom && this.webrtc.on('joinedRoom', function(...args) {\n      onJoinedRoom(this, ...args);\n    });\n    onPeerMute && this.webrtc.on('mute', function(...args) {\n      onPeerMute(this, ...args);\n    });\n    onPeerUnmute && this.webrtc.on('unmute', function(...args) {\n      onPeerUnmute(this, ...args);\n    });\n    onReceivedSignalData && this.webrtc.on('receivedSignalData', function(...args) {\n      onReceivedSignalData(this, ...args);\n    });\n    onPeerStreamAdded && this.webrtc.on('peerStreamAdded', function(...args) {\n      onPeerStreamAdded(this, ...args);\n    });\n    onRemovedPeer && this.webrtc.on('removedPeer', function(...args) {\n      onRemovedPeer(this, ...args);\n    });\n    onConnectionError && this.webrtc.on('connectivityError', function(...args) {\n      onConnectionError(this, ...args);\n    });\n  }\n\n  componentWillUnmount() {\n    this.disconnect();\n  }\n\n  disconnect = () => {\n    try {\n      this.webrtc.stopLocalVideo();\n      this.webrtc.leaveRoom();\n      this.webrtc.disconnect();\n    } catch (e) {\n      // console.log(e);\n    }\n  }\n\n  render() {\n    return (\n      <div>\n        {\n          <Context.Provider value={this.webrtc}>{this.props.children}</Context.Provider>\n        }\n      </div>\n    );\n  }\n}\n\nLioWebRTC.propTypes = {\n  options: PropTypes.object,\n  onReady: PropTypes.func,\n  onJoinedRoom: PropTypes.func,\n  onChannelOpen: PropTypes.func,\n  onReceivedPeerData: PropTypes.func,\n  onConnectionReady: PropTypes.func,\n  onCreatedPeer: PropTypes.func,\n  onPeerStreamRemoved: PropTypes.func,\n  onIceConnectionStateChange: PropTypes.func,\n  onSignalingStateChange: PropTypes.func,\n  onLeftRoom: PropTypes.func,\n  onPeerMute: PropTypes.func,\n  onReceivedSignalData: PropTypes.func,\n  onPeerUnmute: PropTypes.func,\n  onPeerStreamAdded: PropTypes.func,\n  onRemovedPeer: PropTypes.func,\n  onConnectionError: PropTypes.func\n};\n\nLioWebRTC.defaultProps = {\n  options: {\n    dataOnly: true,\n    debug: false\n  }\n};\n\nexport default LioWebRTC;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { withWebRTC } from '../LioWebRTCContext';\n\nclass LocalVideo extends React.Component {\n  componentDidMount() {\n    this.props.webrtc.setLocalVideo(this.localVid);\n    this.props.webrtc.startLocalVideo();\n  }\n\n  render() {\n    return (\n      <video\n        {...this.props.videoProps}\n        id='localVideo'\n        ref={(vid) => { this.localVid = vid; }}\n      />\n    );\n  }\n}\n\nLocalVideo.propTypes = {\n  videoProps: PropTypes.object\n}\n\nexport default withWebRTC(LocalVideo);\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { withWebRTC } from '../LioWebRTCContext';\n\nclass RemoteVideo extends React.Component {\n  componentDidMount() {\n    this.props.webrtc.on('peerStreamAdded', (stream, peer) => {\n      if (peer.id === this.props.peer.id) {\n        this.props.webrtc.attachStream(stream, this.remoteVid);\n      }\n    });\n  }\n\n  render() {\n    return (\n      <video\n        {...this.props.videoProps}\n        id={this.props.webrtc.getDomId(this.props.peer)}\n        ref={(vid) => { this.remoteVid = vid; }}\n      />\n    );\n  }\n}\n\nRemoteVideo.propTypes = {\n  videoProps: PropTypes.object,\n  peer: PropTypes.any.isRequired\n};\n\nexport default withWebRTC(RemoteVideo);\n"],"names":["Context","React","createContext","withWebRTC","Component","ContextComponent","props","webrtc","LioWebRTC","disconnect","stopLocalVideo","leaveRoom","e","Liowebrtc","options","onReady","onReceivedPeerData","onChannelOpen","onConnectionReady","onCreatedPeer","onPeerStreamAdded","onPeerStreamRemoved","onRemovedPeer","onIceConnectionStateChange","onSignalingStateChange","onLeftRoom","onJoinedRoom","onPeerMute","onReceivedSignalData","onPeerUnmute","onConnectionError","on","args","children","propTypes","PropTypes","object","func","defaultProps","LocalVideo","setLocalVideo","localVid","startLocalVideo","videoProps","vid","RemoteVideo","stream","peer","id","attachStream","remoteVid","getDomId","any","isRequired"],"mappings":"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"}