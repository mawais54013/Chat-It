/**
 * Handle event rescue on document
 * @function rescue
 * @param {string} event - Name of event
 * @param {function} handler - Event handler
 */
'use strict';

var get = require('./get');

var debug = require('debug')('the:window:rescue');
/** @lends rescue */


function rescue(handler) {
  var window = get('window');

  if (!window) {
    return;
  }

  window.addEventListener('unhandledrejection', handler);
  {
    var onerror = window.onerror;

    window.onerror = function theErrorRescue(e) {
      debug('error', e);
      onerror && onerror(e);

      if (e.resolved) {
        return;
      }

      handler(e);
    };
  }
}

module.exports = rescue;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlc2N1ZS5qcyJdLCJuYW1lcyI6WyJnZXQiLCJyZXF1aXJlIiwiZGVidWciLCJyZXNjdWUiLCJoYW5kbGVyIiwid2luZG93IiwiYWRkRXZlbnRMaXN0ZW5lciIsIm9uZXJyb3IiLCJ0aGVFcnJvclJlc2N1ZSIsImUiLCJyZXNvbHZlZCIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7QUFNQTs7QUFFQSxJQUFNQSxHQUFHLEdBQUdDLE9BQU8sQ0FBQyxPQUFELENBQW5COztBQUNBLElBQU1DLEtBQUssR0FBR0QsT0FBTyxDQUFDLE9BQUQsQ0FBUCxDQUFpQixtQkFBakIsQ0FBZDtBQUVBOzs7QUFDQSxTQUFTRSxNQUFULENBQWdCQyxPQUFoQixFQUF5QjtBQUN2QixNQUFNQyxNQUFNLEdBQUdMLEdBQUcsQ0FBQyxRQUFELENBQWxCOztBQUNBLE1BQUksQ0FBQ0ssTUFBTCxFQUFhO0FBQ1g7QUFDRDs7QUFDREEsRUFBQUEsTUFBTSxDQUFDQyxnQkFBUCxDQUF3QixvQkFBeEIsRUFBOENGLE9BQTlDO0FBRUE7QUFBQSxRQUNVRyxPQURWLEdBQ3NCRixNQUR0QixDQUNVRSxPQURWOztBQUVFRixJQUFBQSxNQUFNLENBQUNFLE9BQVAsR0FBaUIsU0FBU0MsY0FBVCxDQUF3QkMsQ0FBeEIsRUFBMkI7QUFDMUNQLE1BQUFBLEtBQUssQ0FBQyxPQUFELEVBQVVPLENBQVYsQ0FBTDtBQUNBRixNQUFBQSxPQUFPLElBQUlBLE9BQU8sQ0FBQ0UsQ0FBRCxDQUFsQjs7QUFDQSxVQUFJQSxDQUFDLENBQUNDLFFBQU4sRUFBZ0I7QUFDZDtBQUNEOztBQUNETixNQUFBQSxPQUFPLENBQUNLLENBQUQsQ0FBUDtBQUNELEtBUEQ7QUFRRDtBQUNGOztBQUVERSxNQUFNLENBQUNDLE9BQVAsR0FBaUJULE1BQWpCIiwic291cmNlUm9vdCI6Ii4uL2xpYiIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogSGFuZGxlIGV2ZW50IHJlc2N1ZSBvbiBkb2N1bWVudFxuICogQGZ1bmN0aW9uIHJlc2N1ZVxuICogQHBhcmFtIHtzdHJpbmd9IGV2ZW50IC0gTmFtZSBvZiBldmVudFxuICogQHBhcmFtIHtmdW5jdGlvbn0gaGFuZGxlciAtIEV2ZW50IGhhbmRsZXJcbiAqL1xuJ3VzZSBzdHJpY3QnXG5cbmNvbnN0IGdldCA9IHJlcXVpcmUoJy4vZ2V0JylcbmNvbnN0IGRlYnVnID0gcmVxdWlyZSgnZGVidWcnKSgndGhlOndpbmRvdzpyZXNjdWUnKVxuXG4vKiogQGxlbmRzIHJlc2N1ZSAqL1xuZnVuY3Rpb24gcmVzY3VlKGhhbmRsZXIpIHtcbiAgY29uc3Qgd2luZG93ID0gZ2V0KCd3aW5kb3cnKVxuICBpZiAoIXdpbmRvdykge1xuICAgIHJldHVyblxuICB9XG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCd1bmhhbmRsZWRyZWplY3Rpb24nLCBoYW5kbGVyKVxuXG4gIHtcbiAgICBjb25zdCB7IG9uZXJyb3IgfSA9IHdpbmRvd1xuICAgIHdpbmRvdy5vbmVycm9yID0gZnVuY3Rpb24gdGhlRXJyb3JSZXNjdWUoZSkge1xuICAgICAgZGVidWcoJ2Vycm9yJywgZSlcbiAgICAgIG9uZXJyb3IgJiYgb25lcnJvcihlKVxuICAgICAgaWYgKGUucmVzb2x2ZWQpIHtcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG4gICAgICBoYW5kbGVyKGUpXG4gICAgfVxuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gcmVzY3VlXG4iXX0=